---
- name: Create vpp directory
  file: path=/etc/vpp/sockets state=directory

- name: Write vpp baseline startup config file
  template: src=vEdge_baseline_startup.conf.j2 dest=/etc/vpp/startup.conf
  when: baseline

- name: Write vpp startup config file
  template: src=vEdge_startup.conf.j2 dest=/etc/vpp/startup.conf
  when: not baseline

- name: Update CNF VPP configuration
  template: src=vEdge_cnf.conf.j2 dest=/etc/vpp/setup.gate
  when: cnf

- name: Update VNF VPP configuration
  template:  src=vEdge_vnf.conf.j2 dest=/etc/vpp/setup.gate
  when: vnf

- name: Restart vpp
  service: 
    name: vpp
    state: restarted

- name: Write hugepages sys.conf
  template: src=80-vpp.conf.j2 dest=/etc/sysctl.d/80-vpp.conf

- name: Refresh sysctl
  command: sysctl -p
